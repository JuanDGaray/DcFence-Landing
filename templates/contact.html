{% extends "base.html" %}

{% block title %}Contact - DCFence | Request Your Quote{% endblock %}

{% block meta_description %}Contact DCFence to request a personalized quote for security fences. Specialists in residential, commercial and governmental perimeter security.{% endblock %}

{% block meta_keywords %}contact DCFence, security fence quote, perimeter security consultation, fence budget{% endblock %}

{% block og_title %}Contact - DCFence | Perimeter Security{% endblock %}

{% block og_description %}Request your personalized quote for security fences. Specialists in perimeter security with over 8 years of experience.{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="bg-gradient-to-r from-blue-900 to-blue-700 py-20">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <h1 class="text-4xl md:text-5xl font-bold text-white mb-6">
            Contact Us
        </h1>
        <p class="text-xl text-gray-200 max-w-3xl mx-auto leading-relaxed">
            Our experts are ready to help you choose the best perimeter security solution for your property. Request your free quote.
        </p>
    </div>
</section>

<!-- Contact Section -->
<section class="py-20 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-16">
            <!-- Contact Form -->
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-6">
                    Request Your Quote
                </h2>
                <p class="text-gray-600 mb-8">
                    Complete the form and one of our specialists will contact you within 24 hours.
                </p>
                
                <form id="contactForm" method="POST" action="{{ url_for('contact') }}" class="space-y-6">
                    {{ form.hidden_tag() }}
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="{{ form.name.id }}" class="block text-sm font-medium text-gray-700 mb-2">
                                {{ form.name.label }}
                            </label>
                            {{ form.name(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200", placeholder="Your full name") }}
                            {% if form.name.errors %}
                                <div class="mt-2 text-sm text-red-600">
                                    {% for error in form.name.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div>
                            <label for="{{ form.email.id }}" class="block text-sm font-medium text-gray-700 mb-2">
                                {{ form.email.label }}
                            </label>
                            {{ form.email(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200", placeholder="your@email.com") }}
                            {% if form.email.errors %}
                                <div class="mt-2 text-sm text-red-600">
                                    {% for error in form.email.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="{{ form.phone.id }}" class="block text-sm font-medium text-gray-700 mb-2">
                                {{ form.phone.label }}
                            </label>
                            {{ form.phone(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200", placeholder="+1 (555) 123-4567") }}
                            {% if form.phone.errors %}
                                <div class="mt-2 text-sm text-red-600">
                                    {% for error in form.phone.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div>
                            <label for="{{ form.type_of_request.id }}" class="block text-sm font-medium text-gray-700 mb-2">
                                {{ form.type_of_request.label }}
                            </label>
                            {{ form.type_of_request(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200") }}
                            {% if form.type_of_request.errors %}
                                <div class="mt-2 text-sm text-red-600">
                                    {% for error in form.type_of_request.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label for="{{ form.address.id }}" class="block text-sm font-medium text-gray-700 mb-2">
                                {{ form.address.label }}
                            </label>
                            {{ form.address(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200", placeholder="Project address (optional)") }}
                            {% if form.address.errors %}
                                <div class="mt-2 text-sm text-red-600">
                                    {% for error in form.address.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div>
                            <label for="{{ form.referral.id }}" class="block text-sm font-medium text-gray-700 mb-2">
                                {{ form.referral.label }}
                            </label>
                            {{ form.referral(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200") }}
                            {% if form.referral.errors %}
                                <div class="mt-2 text-sm text-red-600">
                                    {% for error in form.referral.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div id="other-details-group" style="display:none;">
                        <label for="{{ form.other_details.id }}" class="block text-sm font-medium text-gray-700 mb-2">
                            {{ form.other_details.label }}
                        </label>
                        {{ form.other_details(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200", rows="3", placeholder="Please specify your request...") }}
                        {% if form.other_details.errors %}
                            <div class="mt-2 text-sm text-red-600">
                                {% for error in form.other_details.errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    <div>
                        <label for="{{ form.message.id }}" class="block text-sm font-medium text-gray-700 mb-2">
                            {{ form.message.label }}
                        </label>
                        {{ form.message(class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200", rows="5", placeholder="Describe your project or request...") }}
                        {% if form.message.errors %}
                            <div class="mt-2 text-sm text-red-600">
                                {% for error in form.message.errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    <!-- El reCAPTCHA se mueve al modal, así que lo quitamos de aquí -->
                    <button id="sendBtn" type="button" disabled
                            class="w-full font-semibold py-4 rounded-lg text-lg transition-colors duration-200">
                        <i class="fas fa-paper-plane mr-3"></i>
                        Send Message
                    </button>
                    <input type="hidden" name="g-recaptcha-response" id="hiddenRecaptcha">
                </form>

<!-- Modal de reCAPTCHA exclusivo para contacto -->
<div id="contactRecaptchaModal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md">
            <!-- Header -->
            <div class="bg-blue-500 text-white p-4 rounded-t-2xl flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center">
                        <i class="fas fa-shield-alt text-white"></i>
                    </div>
                    <div>
                        <div class="font-semibold">Security Verification</div>
                        <div class="text-sm text-blue-100">Please verify you're human</div>
                    </div>
                </div>
                <button type="button" id="closeContactRecaptchaModal" class="text-white hover:text-gray-200">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <!-- reCAPTCHA Content -->
            <div class="p-6">
                <div class="text-center mb-6">
                    <i class="fas fa-robot text-4xl text-gray-400 mb-4"></i>
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">Verify You're Human</h3>
                    <p class="text-sm text-gray-600">Please complete the verification to send your information to an advisor.</p>
                </div>
                <div class="flex justify-center mb-6">
                    <div id="contact-modal-recaptcha-container"></div>
                </div>
                <div class="flex space-x-3">
                    <button type="button" id="closeContactRecaptchaModalBtn"
                            class="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                    <button type="button" id="contactSendToAdvisorBtn"
                            class="flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                        Send to Advisor
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://www.google.com/recaptcha/api.js?render=explicit" async defer></script>
<script>
// Mostrar/ocultar campo other_details
const typeSelect = document.getElementById('{{ form.type_of_request.id }}');
const otherDetailsGroup = document.getElementById('other-details-group');
function toggleOtherDetails() {
    if (typeSelect.value === 'other') {
        otherDetailsGroup.style.display = '';
    } else {
        otherDetailsGroup.style.display = 'none';
    }
}
typeSelect && typeSelect.addEventListener('change', toggleOtherDetails);
document.addEventListener('DOMContentLoaded', toggleOtherDetails);

const form = document.getElementById('contactForm');
const sendBtn = document.getElementById('sendBtn');
let modalRecaptchaWidgetId = null;
let modalRecaptchaValidated = false;

function allRequiredFilled() {
    const requiredFields = [
        '{{ form.name.id }}',
        '{{ form.email.id }}',
        '{{ form.phone.id }}',
        '{{ form.type_of_request.id }}',
        '{{ form.message.id }}'
    ];
    for (let id of requiredFields) {
        const el = document.getElementById(id);
        if (!el || !el.value || el.value.trim() === '') {
            return false;
        }
    }
    if (typeSelect.value === 'other') {
        const otherDetails = document.getElementById('{{ form.other_details.id }}');
        if (!otherDetails || !otherDetails.value || otherDetails.value.trim() === '') {
            return false;
        }
    }
    return true;
}

function updateSendBtnStyle() {
    if (sendBtn.disabled) {
        sendBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700', 'text-white', 'shadow-lg');
        sendBtn.classList.add('bg-slate-300', 'text-gray-500');
    } else {
        sendBtn.classList.remove('bg-slate-300', 'text-gray-500');
        sendBtn.classList.add('bg-blue-600', 'hover:bg-blue-700', 'text-white', 'shadow-lg');
    }
}

function checkFields() {
    sendBtn.disabled = !allRequiredFilled();
    updateSendBtnStyle();
}

// --- NUEVO: listeners para todos los campos relevantes ---
function addFieldListeners() {
    // Inputs y textareas
    const fields = form.querySelectorAll('input, textarea, select');
    fields.forEach(field => {
        field.addEventListener('input', checkFields);
        field.addEventListener('change', checkFields);
    });
}
document.addEventListener('DOMContentLoaded', function() {
    addFieldListeners();
    checkFields(); // Por si hay autocompletado
    updateSendBtnStyle();
    // Asignar evento click al botón del modal
    var sendToAdvisorBtn = document.getElementById('sendToAdvisorBtn');
    if (sendToAdvisorBtn) {
        sendToAdvisorBtn.addEventListener('click', verifyAndSend);
    }
});
// --- FIN NUEVO ---

// Delegación de eventos global para el botón del modal
// Esto asegura que verifyAndSend se ejecute aunque el botón se inserte dinámicamente
// o haya problemas de listeners directos

document.addEventListener('click', function(e) {
    if (e.target && e.target.id === 'sendToAdvisorBtn') {
        verifyAndSend();
    }
});

typeSelect && typeSelect.addEventListener('change', checkFields);

// Modal logic
sendBtn.addEventListener('click', function(e) {
    if (!sendBtn.disabled) {
        openContactRecaptchaModal();
    }
});

// Lógica para el modal exclusivo de contacto
let contactModalRecaptchaWidgetId = null;
let contactModalRecaptchaValidated = false;

function openContactRecaptchaModal() {
    document.getElementById('contactRecaptchaModal').classList.remove('hidden');
    // Render reCAPTCHA solo una vez
    if (contactModalRecaptchaWidgetId === null && typeof grecaptcha !== 'undefined') {
        contactModalRecaptchaWidgetId = grecaptcha.render('contact-modal-recaptcha-container', {
            'sitekey': '{{ config["RECAPTCHA_PUBLIC_KEY"] }}',
            'callback': function() { contactModalRecaptchaValidated = true; }
        });
    } else if (typeof grecaptcha !== 'undefined') {
        grecaptcha.reset(contactModalRecaptchaWidgetId);
        contactModalRecaptchaValidated = false;
    }
}

function closeContactRecaptchaModal() {
    document.getElementById('contactRecaptchaModal').classList.add('hidden');
    if (contactModalRecaptchaWidgetId !== null && typeof grecaptcha !== 'undefined') {
        grecaptcha.reset(contactModalRecaptchaWidgetId);
        contactModalRecaptchaValidated = false;
    }
}

function contactVerifyAndSend() {
    if (contactModalRecaptchaValidated) {
        // Copia el token del reCAPTCHA del modal al input oculto del formulario
        var recaptchaTextarea = document.getElementById('contact-modal-recaptcha-container').querySelector('textarea[name="g-recaptcha-response"]');
        if (recaptchaTextarea) {
            document.getElementById('hiddenRecaptcha').value = recaptchaTextarea.value;
        }
        closeContactRecaptchaModal();
        if (typeof form.requestSubmit === 'function') {
            form.requestSubmit();
        } else {
            form.submit();
        }
    } else {
        alert('Please complete the reCAPTCHA verification.');
    }
}

document.addEventListener('DOMContentLoaded', function() {
    // ...otros listeners...
    var contactSendToAdvisorBtn = document.getElementById('contactSendToAdvisorBtn');
    if (contactSendToAdvisorBtn) {
        contactSendToAdvisorBtn.addEventListener('click', contactVerifyAndSend);
    }
    var closeContactRecaptchaModalBtn = document.getElementById('closeContactRecaptchaModalBtn');
    if (closeContactRecaptchaModalBtn) {
        closeContactRecaptchaModalBtn.addEventListener('click', closeContactRecaptchaModal);
    }
    var closeContactRecaptchaModalX = document.getElementById('closeContactRecaptchaModal');
    if (closeContactRecaptchaModalX) {
        closeContactRecaptchaModalX.addEventListener('click', closeContactRecaptchaModal);
    }
});
</script>
            </div>
            
            <!-- Contact Information -->
            <div class="space-y-8">
                <!-- Company Info -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h3 class="text-xl font-bold text-gray-900 mb-6">
                        Contact Information
                    </h3>
                    
                    <div class="space-y-6">
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-phone text-blue-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-1">Phone</h4>
                                <p class="text-gray-600">786-747-4766</p>
                                <p class="text-sm text-gray-500">Mon-Fri: 8:00 AM - 6:00 PM</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-envelope text-blue-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-1">Email</h4>
                                <p class="text-gray-600">dcfenceapp@dcfence.org</p>
                                <p class="text-sm text-gray-500">Response within 24 hours</p>
                            </div>
                        </div>
                        
 

                        
                        <div class="flex items-start">
                            <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mr-4 flex-shrink-0">
                                <i class="fas fa-clock text-blue-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-900 mb-1">Hours</h4>
                                <p class="text-gray-600">Monday - Friday: 8:00 AM - 6:00 PM</p>
                                <p class="text-gray-600">Saturday: 9:00 AM - 2:00 PM</p>
                                <p class="text-sm text-gray-500">24/7 Emergency Support</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Services Quick Info -->
                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h3 class="text-xl font-bold text-gray-900 mb-6">
                        Our Services
                    </h3>
                    
                    <div class="space-y-4">
                        <div class="flex items-center p-4 bg-gray-50 rounded-lg">
                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-home text-blue-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-900">Residential Fences</h4>
                                <p class="text-sm text-gray-600">Customized protection</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center p-4 bg-gray-50 rounded-lg">
                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-building text-blue-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-900">Commercial Fences</h4>
                                <p class="text-sm text-gray-600">Business security</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center p-4 bg-gray-50 rounded-lg">
                            <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-4">
                                <i class="fas fa-shield-alt text-blue-600"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-900">Governmental Fences</h4>
                                <p class="text-sm text-gray-600">Military-grade security</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Map Section -->
<section class="py-20 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
                Our Location
            </h2>
            <p class="text-xl text-gray-600">
                Visit us at our main offices
            </p>
        </div>
        
        <div class="bg-gray-200 rounded-2xl h-96 flex items-center justify-center overflow-hidden">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3590.769254613246!2d-80.29198562377118!3d25.844147705191983!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x88d9bbfcfeaadcb1%3A0xbca235329ec64165!2sDC%20Fence%20Solutions!5e0!3m2!1sen!2sco!4v1752726044170!5m2!1sen!2sco" 
                    width="100%" 
                    height="100%" 
                    style="border:0;" 
                    allowfullscreen="" 
                    loading="lazy" 
                    referrerpolicy="no-referrer-when-downgrade">
            </iframe>
        </div>
    </div>
</section>

<!-- FAQ Section -->
<section class="py-20 bg-gray-50">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">
                Frequently Asked Questions
            </h2>
            <p class="text-xl text-gray-600">
                We answer the most common questions about our services
            </p>
        </div>
        
        <div class="space-y-6">
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">
                    How long does it take to install a security fence?
                </h3>
                <p class="text-gray-600 leading-relaxed">
                    Installation time varies depending on the size and complexity of the project. Residential projects typically take 1-3 days, while commercial projects can take 1-2 weeks.
                </p>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">
                    Do you offer maintenance after installation?
                </h3>
                <p class="text-gray-600 leading-relaxed">
                    Yes, we offer preventive and corrective maintenance services. Our maintenance plans include regular inspections, cleaning and minor repairs.
                </p>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">
                    What types of warranty do you offer?
                </h3>
                <p class="text-gray-600 leading-relaxed">
                    We offer 5-year warranty on materials and 2-year warranty on labor. For government projects, we extend the warranty according to specific requirements.
                </p>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg p-8">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">
                    Can you integrate with existing security systems?
                </h3>
                <p class="text-gray-600 leading-relaxed">
                    Absolutely. Our systems are compatible with most existing security systems. We conduct a comprehensive evaluation to ensure perfect integration.
                </p>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="py-20 gradient-bg">
    <div class="max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8">
        <h2 class="text-3xl md:text-4xl font-bold text-white mb-6">
            Ready to protect your property?
        </h2>
        <p class="text-xl text-gray-200 mb-8 leading-relaxed">
            Our experts are ready to evaluate your needs and provide you with the best perimeter security solution.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a href="#contact-form" 
               class="inline-flex items-center justify-center px-8 py-4 text-lg font-semibold bg-white text-blue-600 rounded-lg shadow-lg hover:bg-gray-100 transition-all duration-300">
                <i class="fas fa-phone mr-3"></i>
                Request Quote
            </a>
            <a href="{{ url_for('home') }}" 
               class="inline-flex items-center justify-center px-8 py-4 text-lg font-semibold text-white border-2 border-white rounded-lg hover:bg-white hover:text-blue-600 transition-all duration-300">
                <i class="fas fa-info-circle mr-3"></i>
                Learn About Services
            </a>
        </div>
    </div>
</section>
{% endblock %} 

<style>
#sendBtn:disabled {
    background-color: #cbd5e1 !important; /* Tailwind slate-300 */
    color: #6b7280 !important; /* Tailwind gray-500 */
    cursor: not-allowed !important;
    border: none;
    opacity: 0.7;
    box-shadow: none !important;
    transition: background 0.2s, color 0.2s, box-shadow 0.2s, opacity 0.2s;
}
#sendBtn:not(:disabled) {
    background-color: #2563eb !important; /* Tailwind blue-600 */
    color: #fff !important;
    opacity: 1;
    box-shadow: 0 10px 15px -3px rgba(37,99,235,0.2);
    transition: background 0.2s, color 0.2s, box-shadow 0.2s, opacity 0.2s;
}
#sendBtn:not(:disabled):hover {
    background-color: #1d4ed8 !important; /* Tailwind blue-700 */
    box-shadow: 0 15px 25px -5px rgba(37,99,235,0.3);
}
</style> 
</style> 
